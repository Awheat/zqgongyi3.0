define("find_pwd",["jquery","jquery.validate","utils/utils.form.js"],function(require,exports,module){var $=require("jquery");require("jquery.validate");var e=require("utils/utils.form.js");$(function(){var r={dom:{formFindPwdOne:$("#formFindPwdOne"),formFindPwdTwo:$("#formFindPwdTwo"),formFindPwdThree:$("#formFindPwdThree"),btnGetMsgCode:$(".btn-msg")},isajax:!1,init:function(){this.dom.formFindPwdOne.validate(this.validatorConfigOne),this.dom.formFindPwdTwo.validate(this.validatorConfigTwo),this.dom.formFindPwdThree.validate(this.validatorConfigThree),e.addValidatorRules("isUsernameOrPhone",[e.regs.mobile,e.regs.username],"请输入合法的昵称或手机号"),this.bindEvent()},bindEvent:function(){var r=this;this.dom.btnGetMsgCode.showError=function(e){var r=$("#msgcode-error");0==r.length&&($("#msgcode").after('<label id="msgcode-error" class="error" for="msgcode"></label>'),r=$("#msgcode-error")),e.errcode>=0?r.text(""):r.text(e.errmsg).show()},this.dom.btnGetMsgCode.on("click",function(){if(!r.isajax){r.isajax=!0;var t=$(this),a=t.attr("data-url");$.post(a,function(a){r.isajax=!1;var o=a.errcode;r.dom.btnGetMsgCode.showError(a),o>=0&&e.countDown(t,60)})}})},validatorConfigOne:{onkeyup:!1,rules:{usernameortel:{required:!0,isUsernameOrPhone:!0},vdcode:{required:!0,remote:function(){return $("#vdcode").attr("data-url")}}},messages:{usernameortel:{required:"请输入手机号或者用户名"},vdcode:{required:"请输入验证码",remote:"验证码错误"}},submitHandler:function(e){var r=$(e),t=r.serialize(),a=r.attr("data-url");$.ajax({url:a,data:t,type:"post",dataType:"json",success:function(r){var t=r.errcode;if(t<0){var a=r.errmsg,o={"-1":"usernameortel","-2":"vdcode"},i=o[t]+"-error",s=$("#"+i);0==s.length&&($("#"+o[t]).after('<label id="'+o[t]+'-error" class="error" for="'+o[t]+'"></label>'),s=$("#"+i)),s.text(a).show()}else e.submit()}})}},validatorConfigTwo:{rules:{msgcode:{required:!0}},messages:{msgcode:{required:"请输入短信验证码"}},submitHandler:function(e){var t=this;if(!t.isajax){t.isajax=!0;var a=$(e),o=a.attr("data-url"),i=$("#msgcode").val();$.ajax({url:o,data:{code:i},dataType:"json",type:"post",success:function(a){var o=a.errcode;r.dom.btnGetMsgCode.showError(a),o<0?t.isajax=!1:e.submit()}})}}},validatorConfigThree:{rules:{newpassword:{required:!0,rangelength:[6,32]},repassword:{required:!0,equalTo:"#newpassword"}},messages:{newpassword:{required:"请输入新密码",rangelength:$.validator.format("请输入{0}至{1}位新密码")},repassword:{required:"请再次输入新密码",equalTo:"两次密码不一致"}}}};r.init()})}),define("utils/utils.form",["jquery"],function(require,exports,module){var $=require("jquery"),e={timer:null,toString:Object.prototype.toString,isArray:function(e){return"[object Array]"===this.toString.call(e)},isString:function(e){return"[object String]"===this.toString.call(e)},isObject:function(e){return"[object Object]"===this.toString.call(e)},isRegEx:function(e){return"[object RegExp]"===this.toString.call(e)},regs:{username:/^[_a-zA-Z0-9\u4E00-\u9FA5]{2,10}$/,mobile:/^1\d{10}$/,email:/^[a-zA-Z0-9_\-]{1,}@[a-zA-Z0-9_\-]{1,}\.[a-zA-Z0-9_\-.]{1,}$/},countDown:function(e,r){var t=this;e.hasClass("disable")||(e.addClass("disable").attr("disabled","disabled"),this.timer=setInterval(function(){e.text(r+" 秒"),r==-1&&(e.text("获取短信验证码").removeClass("disable").attr("disabled",!1),clearInterval(t.timer)),r--},1e3))},addValidatorRules:function(e,r,t){var a=this,o=!0;$.validator.addMethod(e,function(e,t){if(a.isArray(r)){for(var i=0;i<r.length&&!(o=r[i].test(e));i++);return o}return this.optional(t)||r.test(e)},t)}};module.exports=e});