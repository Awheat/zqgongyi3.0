define("regist",["jquery","jquery.validate","utils/utils.form.js"],function(require,exports,module){var $=require("jquery");require("jquery.validate");var e=require("utils/utils.form.js");$(function(){var t={dom:{formRegist:$("#formRegist"),btnGetMsgCode:$(".btn-msg")},init:function(){this.dom.formRegist.validate(this.validatorConfig),e.addValidatorRules("isMobile",e.regs.mobile,"请输入合法手机号"),e.addValidatorRules("isName",e.regs.username,"请输入合法用户名"),this.bindEvent()},bindEvent:function(){this.dom.btnGetMsgCode.on("click",function(){var t=$(this);$.ajax({url:t.attr("data-url"),type:"post",dataType:"json",data:{telephone:$("#telephone").val()},success:function(r){if(r.errcode>=0)e.countDown(t,60);else{var a=$("#msgcode-error");0==a.length&&($("#msgcode").parent().append('<label id="msgcode-error" class="error" for="msgcode"></label>'),a=$("#msgcode-error")),a.text(r.errmsg).show()}}})})},validatorConfig:{ignore:":hidden",onkeyup:!1,submitHandler:function(e){var t=$(e).serialize();alert(t),$.ajax({url:$(e).attr("data-url"),type:"post",dataType:"json",data:t,success:function(e){console.log(e)}})},errorPlacement:function(e,t){e.appendTo(t.parent())},success:function(e){"telephone"===e[0].getAttribute("for")&&(t.dom.btnGetMsgCode.removeClass("disable"),t.dom.btnGetMsgCode.removeAttr("disabled"))},showErrors:function(e,r){if(console.log(r.length),this.defaultShowErrors(),0!=r.length){var a=r[0].element,o=$(a).attr("id");"telephone"==o&&t.dom.btnGetMsgCode.attr("disabled","disabled").addClass("disable")}},rules:{telephone:{required:!0,isMobile:!0},msgcode:{required:!0},username:{required:!0,rangelength:[2,10],isName:!0,remote:{url:$("#username").attr("data-url"),type:"post",data:{username:function(){return $("#username").val()}}}},password:{required:!0,rangelength:[6,16]},repassword:{required:!0,rangelength:[6,16],equalTo:"#password"},vdcode:{required:!0,remote:{url:$("#vdcode").attr("data-url"),type:"post",data:{vdcode:function(){return $("#vdcode").val()}}}},isagree:{required:!0}},messages:{telephone:{required:"手机号不能为空"},msgcode:{required:"短信验证码不能为空",remote:"短信验证码错误"},username:{required:"昵称不能为空",rangelength:$.validator.format("请输入{0}至{1}个中文字符"),remote:"此昵称已被注册"},password:{required:"密码不能为空",rangelength:$.validator.format("请输入{0}至{1}位密码")},repassword:{required:"密码不能为空",rangelength:$.validator.format("请再次输入{0}至{1}位密码"),equalTo:"两次输入密码不一致"},vdcode:{required:"验证码不能为空",remote:"验证码错误"},isagree:{required:"未同意相关服务条款"}}}};t.init()})}),define("utils/utils.form",["jquery"],function(require,exports,module){var $=require("jquery"),e={timer:null,toString:Object.prototype.toString,isArray:function(e){return"[object Array]"===this.toString.call(e)},isString:function(e){return"[object String]"===this.toString.call(e)},isObject:function(e){return"[object Object]"===this.toString.call(e)},isRegEx:function(e){return"[object RegExp]"===this.toString.call(e)},regs:{username:/^[_a-zA-Z0-9\u4E00-\u9FA5]{2,10}$/,mobile:/^1\d{10}$/,email:/^[a-zA-Z0-9_\-]{1,}@[a-zA-Z0-9_\-]{1,}\.[a-zA-Z0-9_\-.]{1,}$/},countDown:function(e,t){var r=this;e.hasClass("disable")||(e.addClass("disable").attr("disabled","disabled"),this.timer=setInterval(function(){e.text(t+" 秒"),t==-1&&(e.text("获取短信验证码").removeClass("disable").attr("disabled",!1),clearInterval(r.timer)),t--},1e3))},addValidatorRules:function(e,t,r){var a=this,o=!0;$.validator.addMethod(e,function(e,r){if(a.isArray(t)){for(var i=0;i<t.length&&!(o=t[i].test(e));i++);return o}return this.optional(r)||t.test(e)},r)}};module.exports=e});