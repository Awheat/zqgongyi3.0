define("ucenter",["jquery","jquery.validate","distpicker","utils/utils.form.js"],function(require,exports,module){var $=require("jquery");require("jquery.validate"),require("distpicker");require("utils/utils.form.js");$(function(){var e={formBaseInfo:$("#formBaseInfo"),distpicker:$(".distpicker"),btnEditBaseInfo:$(".btn-edit-baseinfo"),btnEditRealInfo:$(".btn-edit-realinfo"),btnAddLabel:$(".btn-add-skill"),btnCancel:$(".btn-cancel"),formHiddenGender:$('input[name="gender'),formHiddenSphere:$('input[name="sphere'),formHiddenSkills:$('input[name="skills'),init:function(){var e=this,i=e.splitBySpace($(".sw_address").text());this.editfields={name:$("#username"),gender:$(".gender"),address:$(".distpicker"),sphere:$(".sphere"),skills:$(".list-skills")},this.baseInfo={name:$(".sw_name").text(),gender:"男"===$(".sw_gender").text()?0:1,address:{province:i[0],city:i[1],district:i[2]},sphere:e.splitBySpace($(".sw_sphere").attr("data-id")),skills:e.splitBySpace($(".sw_skills").text())},this.validate=this.formBaseInfo.validate(this.validatorConfigOne),this.bindEvent()},bindEvent:function(){var e=this;this.btnEditBaseInfo.on("click",function(){$(".baseinfo-edit").removeClass("hidden").prev("div.baseinfo-show").addClass("hidden"),e.editBaseInfo(e.baseInfo)}),this.editfields.gender.on("click","span.cn-radio",function(){var i=$(this);i.addClass("cur").siblings("span").removeClass("cur"),e.formHiddenGender.val(i.attr("data-gid"))}),this.editfields.sphere.on("click","i[data-id]",function(){$("#sphere-error").text(""),$(this).toggleClass("chk"),e.reloadSphereValue()}),this.btnAddLabel.on("click",function(){var i=$(this),t=i.prev("input"),s=new Array,n=e.formHiddenSkills.val();if(""!=t.val()){var r=t.val().split(/[,\n\s]/g);s=""!==n?n.split(",").concat(r):r,e.setSkills(s),t.val("")}}),this.editfields.skills.on("click","i",function(){$(this).parent().remove(),e.reloadSkillsValue()}),this.btnCancel.on("click",function(){$(".baseinfo-edit").addClass("hidden").prev("div.baseinfo-show").removeClass("hidden")})},editBaseInfo:function(e){this.editfields.name.val(e.name),this.setGender(e.gender),this.distpicker.distpicker(e.address),this.setSphere(e.sphere),this.setSkills(e.skills)},setGender:function(e){var e=e||0,i=this.editfields.gender.find("span.cn-radio");$(i[e]).addClass("cur").siblings("span").removeClass("cur"),this.formHiddenGender.val(e)},setSphere:function(e){var i=this,e=e||[],t=this.editfields.sphere.find("i[data-id]");i.formHiddenSphere.val(e);for(var s=0,n=e.length;s<n;s++)$(t[s]).addClass("chk")},setSkills:function(e){var e=e||[],i=this;i.formHiddenSkills.val(e);for(var t=0,s=e.length;t<s;t++)""!==e[t]&&i.editfields.skills.append("<span>"+e[t]+"<i></i></span>")},reloadSphereValue:function(){var e=[];this.editfields.sphere.find("i.chk").each(function(){e.push($(this).attr("data-id"))}),this.formHiddenSphere.val(e)},reloadSkillsValue:function(){var e=[];this.editfields.skills.find("span").each(function(){e.push($(this).text())}),this.formHiddenSkills.val(e)},splitBySpace:function(e){return e.split(/[,\n\s]/g)},validatorConfigOne:{ignore:"",rules:{username:{required:!0},sphere:{required:!0}},messages:{username:{required:"请输入昵称"},sphere:{required:"请选择关注领域"}}}};e.init()})}),define("utils/utils.form",["jquery"],function(require,exports,module){var $=require("jquery"),e={timer:null,toString:Object.prototype.toString,isArray:function(e){return"[object Array]"===this.toString.call(e)},isString:function(e){return"[object String]"===this.toString.call(e)},isObject:function(e){return"[object Object]"===this.toString.call(e)},isRegEx:function(e){return"[object RegExp]"===this.toString.call(e)},regs:{username:/^[_a-zA-Z0-9\u4E00-\u9FA5]{2,10}$/,mobile:/^1\d{10}$/,email:/^[a-zA-Z0-9_\-]{1,}@[a-zA-Z0-9_\-]{1,}\.[a-zA-Z0-9_\-.]{1,}$/},countDown:function(e,i){var t=this;e.hasClass("disable")||(e.addClass("disable").attr("disabled","disabled"),this.timer=setInterval(function(){e.text(i+" 秒"),i==-1&&(e.text("获取短信验证码").removeClass("disable").attr("disabled",!1),clearInterval(t.timer)),i--},1e3))},addValidatorRules:function(e,i,t){var s=this,n=!0;$.validator.addMethod(e,function(e,t){if(s.isArray(i)){for(var r=0;r<i.length&&!(n=i[r].test(e));r++);return n}return this.optional(t)||i.test(e)},t)}};module.exports=e});